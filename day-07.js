// Advent of Code 2025 day 7

const input = `
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^...^.^...................................................................
.............................................................................................................................................
..................................................................^...^.^.^..................................................................
.............................................................................................................................................
.................................................................^...^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.^.^.....^.^................................................................
.............................................................................................................................................
...............................................................^...^.....^...^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^...^.^.^.^..............................................................
.............................................................................................................................................
.............................................................^.....^...^.....^.^.............................................................
.............................................................................................................................................
............................................................^...^.^.^.^.......^.^............................................................
.............................................................................................................................................
...........................................................^.^.^.^...^.^.^.^...^.^...........................................................
.............................................................................................................................................
..........................................................^.....^.^.^.^.....^.^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^...^.^.^.^...^...^.........................................................
.............................................................................................................................................
........................................................^.^...^.^.^.^.....^.^.^.....^........................................................
.............................................................................................................................................
.......................................................^...^...^...^.^.^.....^.....^.^.......................................................
.............................................................................................................................................
......................................................^.^.^...^.^.^.^.^.^.^.^...^.^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^.......^.^.^.^.^.^.^...^.^.....................................................
.............................................................................................................................................
....................................................^...^.^.^.^...^...^.^.....^.^.^.^.^.^....................................................
.............................................................................................................................................
...................................................^.^.^.^...^.^...^.^.^.^...^...^.^.^.^.^...................................................
.............................................................................................................................................
..................................................^.^.^.^.....^.^...^.^...^.^...^.^...^...^..................................................
.............................................................................................................................................
.................................................^...^.^.^.....^.^.^.....^.^.^...^.^.^.^.^.^.................................................
.............................................................................................................................................
................................................^.^.........^.^.^.^.^.^.^.......^.^...^.^.^.^................................................
.............................................................................................................................................
...............................................^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^...^...^.^..............................................
.............................................................................................................................................
.............................................^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.......^...^.............................................
.............................................................................................................................................
............................................^...^.^.^.^...^.^.^.^.^.^.^.^.....^.^.^.^.^...^.^...^............................................
.............................................................................................................................................
...........................................^.^.^...^.^.^.^...^.^.^.^...^.^.^.^.^.^...^.^.^...^.^.^...........................................
.............................................................................................................................................
..........................................^...^...^.^...^.^.^...^.^.^.^...^...^.^...^.^...^.^.^...^..........................................
.............................................................................................................................................
.........................................^.^...^...^.^...^.^...^.^.....^.^.^...^.^...^.^.^.^.^.....^.........................................
.............................................................................................................................................
........................................^.^.^...^.^.^.....^...^.^...^.^...^.^.^.^...........^.^.^.^.^........................................
.............................................................................................................................................
.......................................^.^.^.^...^...^...^.^.^.^...^.^.^.^.^.....^.^...^.^.^.........^.......................................
.............................................................................................................................................
......................................^.^.^.^.^...^.....^.^.^...^.......^.^...^.....^.^...^.^.^.^...^.^......................................
.............................................................................................................................................
.....................................^...^.^.^.^.^...^...^.^.....^...^...^...^.^.......^.^.^...^...^.^.^.....................................
.............................................................................................................................................
....................................^.^...^.^...^.^.....^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.^...^...^.^....................................
.............................................................................................................................................
...................................^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^...^...^.^...^.^...^...................................
.............................................................................................................................................
..................................^...^.^.^.^.^...^.^.^.........^.^.^...^.^.^.^.^.^.....^.^...^.^...^.....^..................................
.............................................................................................................................................
.................................^.^...^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^...^.^.^.^...^.....^...^.................................
.............................................................................................................................................
................................^.^.^.^.^.^.....^.^.^.^.^.....^.^...^...^...^...^.^.^...^.^.....^.^...^.....^................................
.............................................................................................................................................
...............................^...^...^.^...^.^.^.^.^...^.^.......^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.....^...^...............................
.............................................................................................................................................
..............................^...^.......^.^.^...^.^...^.^...^.^.^.^.^.^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.....^..............................
.............................................................................................................................................
.............................^.......^.^.^...^.^.^.^.^.^.^.^.........^.^...^.^.^.^.....^.....^...^.^.^...^.^.^.^.............................
.............................................................................................................................................
............................^.^.^.^.......^.....^.^.^.^...^.^...^.....^.....^...^...^.^.^.^...^.^.^...^.^.^.^.^.^............................
.............................................................................................................................................
...........................^...^.^.^.^.......^.^.^...^...^.^.^.^.^.^...^.....^.....^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.^.^.^.....^...^.^.^.^.^.....^.......^.....^.^.^.^.^...^.^.^.^.^.^.^.^.^.....^.^.^.^..........................
.............................................................................................................................................
.........................^.^...^...^.^...^.....^...^...^...^.^.^.....^.^.^...^...^.^.^.....^.^.^.^.^.^.^.^.^...^.^.^.........................
.............................................................................................................................................
........................^.^.^.^.^.^.^.^...^...........^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^.^.^........................
.............................................................................................................................................
.......................^...^.^...^...^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^...^.^...^.^.^...^...^.^.....^.^...^.^.......................
.............................................................................................................................................
......................^.^...^.....^.^...^...^.^.....^.^.^...^...^...^.^.^.^.^.^...^...^.^.^.......^...^.^.^.^...^.^.^.^......................
.............................................................................................................................................
.....................^.^...^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.....^.^.^.^...^.^...^.^.^...^.^...^.^.^...^.^.^.....................
.............................................................................................................................................
....................^.^.^...^.^...^.^.^.^.^.^.^.^...^.^...^.^.^.^...^.^.^...^.......^.^.....^.^.^...^.^.^...^.^.^.^.^.^.^....................
.............................................................................................................................................
...................^.^.....^.^.^.^.^.^.^.^.^...^.^.^...^...^.....^.^.^...^.....^.^.^...^.^...^.^.^.^...^.......^...^.^.^.^...................
.............................................................................................................................................
..................^.^.....^...^.^...^.^.^.^...^.^.^...^.^.^...^...^.^.....^...^.^.^.^.^.^...^.^.^.^...^.^.........^...^.^.^..................
.............................................................................................................................................
.................^...^.^.^.^.^.....^...^.^.^.^...^.^.^...^.^.^.^.^.^.......^.^.^.^.....^.........^...^.^...^.^.^.^.....^.^.^.................
.............................................................................................................................................
................^.^...^...^.^.^...^...^...^.^.^.^.^...^.....^.^.^...^.^.^.^...^.^.^.....^.^.^.^.....^...^.^.^.^.^...^.^.^.^.^................
.............................................................................................................................................
...............^.^.^...^...^.^.^.^...^.^.^.....^...^.^.^.^.^.^.^.^.^.^.........^...^.....^.^.^.^.^.^...^.^.^.^.^.......^.^...^...............
.............................................................................................................................................
..............^...^.^.^.^.^.^.^.^.^...^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^...^.^...^.^.....^.....^.....^...^.^..............
.............................................................................................................................................
.............^...^.....^.^.^...^.^...^...^.^.^.^...^...^.^.^.^...^...^.^.^.^...^...^.^.^...^...^...^...^.^...^...^.....^...^.^.^.............
.............................................................................................................................................
............^...^...^.^.^.^...^.^.^...^.^.....^...^.^...^.^.^.....^.....^.^.......^...^.^.^.^...^.^.^...^.^...^.^.^...^.^.^...^.^............
.............................................................................................................................................
...........^.^...^.....^.....^.^.^.....^.....^.^.^.^.^.........^.^.^.....^.^.^...^...^.^.^.^.^...^.^...^.^.^.^.....^...^.^.^...^.^...........
.............................................................................................................................................
..........^.^.^.^.^.^.^...^.^.^...^...^...^...^.^.^.^.^.^.^.^...^...^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^...^.^.^.^.....^.^.^...^.^.^..........
.............................................................................................................................................
.........^.....^...^.^.^...^.^...^.^...^...^...^.^.^...^.^.^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.....^.^...^.^.^.^.^...^.^.........
.............................................................................................................................................
........^.^.^.^.^...^.^...^.^.^...^...^.^.^...^.....^.^.....^.^.^.^.^.^.^.^.^.^...^...^.....^.^.^.^.^.^.^.....^.^.^.^...^.^...^.^.^.^........
.............................................................................................................................................
.......^...^...^.^.^.....^.^.......^.^.^.^.^.^.......^.^...^.^.^.^.^.^.^.^.^.^.......^.^...^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^.^.^.......
.............................................................................................................................................
......^...^.^.^.^.^...^.^...^...^.........^...^.^.^.^.^.^...^...^.^.^.^.....^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^......
.............................................................................................................................................
.....^.^.^...^.^.^...^.^...^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^...^.^.^.^.^.^.^...........^.^...^.^...^.^.^.^...^...^.^.^.^.^.....
.............................................................................................................................................
....^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^...^...^.....^.....^...^.^.^.^.....^.^.^.^.......^.^...^...^.^.^.^...^.^.^.^.^...^.^.^...^.^....
.............................................................................................................................................
...^.^.....^.^.^...^.^.^.....^.^.^.....^.^.^.....^...^.^.......^.^.^.^.....^.^.....^...^...^...^.^...^.^.^.^.^...^.^.^.^.^...^...^...^.^.^...
.............................................................................................................................................
..^.....^.^.^.^.^.^.^.^...^...^.^.....^.^.....^.......^.^.^.....^...^...^.^.^.^...^.....^.^.^.^.^.^.^.^.^.......^.^.^.....^...^.^.^...^.^.^..
.............................................................................................................................................
.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.....^.^...^...^.^...^...^.....^...^.^.......^.^.....^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^...^.^.^.
.............................................................................................................................................

`;

let total = 0;

// convert the input to a 2D array
const manifold = input
	.trim()
	.split(`\n`)
	.map(row =>
		row.split(``)
	);

// create a set of numbers to mark the x-positions of all current beams
const beams = new Set();

// add start point
beams.add(manifold[0].indexOf(`S`));

for (let y = 1; y < manifold.length; y++) {
	for (const x of beams) {
		if (manifold[y][x] === `^`) {
			beams.delete(x);
			beams.add(x - 1);
			beams.add(x + 1);
			total++;
		}
	}
}

console.log(`The number of splits is ${total}.`); // Answer: 1658

// record the number of paths at each x coordinate
const paths = Array(manifold[0].length).fill(0);
paths[manifold[0].indexOf(`S`)]++;

// for each row, check whether existing paths (i.e. paths with at least one beam)
// encounter a splitter; if so, add the number of beams in that path to each neighbour
// (i.e. doubling the original path's beam count) and remove all beams from that path
for (let y = 1; y < manifold.length; y++) {
	for (let x = 0; x < paths.length; x++) {
		if (paths[x] === 0) continue;

		if (manifold[y][x] === `^`) {
			paths[x - 1] += paths[x];
			paths[x + 1] += paths[x];
			paths[x] = 0;
		}
	}
}

// sum all beam counts across all paths at the end of the manifold
total = paths.reduce((acc, a) => acc + a, 0);

console.log(`The number of paths is ${total}.`) // Answer: 53916299384254
